<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.5.5 -->
<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc docmapping="yes"?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-rdb-ohai-feedback-to-proxy-02" category="std" obsoletes="" updates="" submissionType="IETF" xml:lang="en" tocInclude="true" sortRefs="true" symRefs="true" version="3">
  <!-- xml2rfc v2v3 conversion 3.9.1 -->
  <front>
    <title>Oblivious Proxy Feedback</title>
    <seriesInfo name="Internet-Draft" value="draft-rdb-ohai-feedback-to-proxy-02"/>
    <author initials="T." surname="Reddy" fullname="Tirumaleswar Reddy">
      <organization>Akamai</organization>
      <address>
        <postal>
          <street>Embassy Golf Link Business Park</street>
          <city>Bangalore</city>
          <region>Karnataka</region>
          <code>560071</code>
          <country>India</country>
        </postal>
        <email>kondtir@gmail.com</email>
      </address>
    </author>
    <author initials="D." surname="Wing" fullname="Dan Wing">
      <organization abbrev="Citrix">Citrix Systems, Inc</organization>
      <address>
        <postal>
          <street>4988 Great America Pkwy</street>
          <city>Santa Clara</city>
          <region>CA</region>
          <code>95054</code>
          <country>USA</country>
        </postal>
        <email>danwing@gmail.com</email>
      </address>
    </author>
    <author initials="M." surname="Boucadair" fullname="Mohamed Boucadair">
      <organization>Orange</organization>
      <address>
        <postal>
          <city>Rennes</city>
          <code>35000</code>
          <country>France</country>
        </postal>
        <email>mohamed.boucadair@orange.com</email>
      </address>
    </author>
    <date year="2022" month="April" day="27"/>
    <area>Security</area>
    <workgroup>ohai</workgroup>
    <keyword>Internet-Draft</keyword>
    <abstract>
      <t>To provide equitable service to clients, servers often rate-limit
incoming requests, for example based upon the source IP address.
However, oblivious HTTP removes the ability for the server to distinguish
amongst originating clients so the server can only rate-limit traffic from the
oblivious proxy. This harms all clients behind that oblivious proxy.</t>
      <t>This specification enables a server to convey rate limit information
to an oblivious proxy, which can thus use them to apply rate-limit policies
on oblivious clients.
Cooperating oblivious proxies can thus provide more
equitable service to their distinguishable clients without impacting
on all clients behind that Oblivious proxy.</t>
    </abstract>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" toc="default">
      <name>Introduction</name>
      <t>Oblivious HTTP <xref target="OHTTP" format="default"/> describes a method for the
forwarding encrypted HTTP messages.
This enables a deployment architecture that can
separate the identity of a requester from the request.
This architecture requires explicit support of origin servers and intermediaries.</t>
      <t>Since oblivious clients are behind such an architecture,
origin servers cannot distinguish between well-behaving and
malicious clients: an unexpected behavior from one or more clients
can then impact on all the intermediated clients,
as described in <xref section="8.2.1" sectionFormat="of" target="OHTTP" format="default"/>.
This can be problematic when the origin server
implements rate limiting policies based on information
masked by the oblivious architecture, such as the source IP address.</t>
      <t>This document defines a mechanism
that allows Oblivious request and target resource
to provide rate limit information to an Oblivious proxy
via the RateLimit fields defined in <xref target="RATELIMIT" format="default"/>.
This is useful when such servers identify traffic anomalies
or unexpected request volumes.
The Oblivious proxy can then use this information
to apply rate-limit policies on oblivious clients.</t>
      <t>While <xref target="RATELIMIT" format="default"/> goal is to provide enough information
to generic clients to shape their request policy and avoid
being throttled out,
this specification allows an Oblivious server to explicit that
RateLimit information are targeted to an Oblivious proxy.</t>
      <t>How an Oblivious proxy can use this information to avoid being throttled
out or shape the request policy is outside the scope of this specification.</t>
      <section anchor="terminology" numbered="true" toc="default">
        <name>Terminology</name>
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP&nbsp;14 <xref target="RFC2119" format="default"/> <xref target="RFC8174" format="default"/> when, and only when, they
appear in all capitals, as shown here.</t>
        <t>The terms
"Encapsulated request", "Encapsulated response",
"Oblivious proxy resource", "Oblivious request resource",
"Oblivious target resource" are to be interpreted as described
in <xref target="OHTTP" format="default"/>.</t>
        <t>The collective term "Oblivious resource" indicates either
an "Oblivious request resource" or an "Oblivious target resource".</t>
        <t>The terms "content", "receiver", "request" and "response"
are to be interpreted as described in <xref target="HTTP" format="default"/>.</t>
        <t>The terms "quota policy", "service limit", "expiring limit"
and "RateLimit fields"
are to be interpreted as described in <xref target="RATELIMIT" format="default"/>.</t>
        <t>This document uses the Integer type
from <xref target="STRUCTURED-FIELDS" format="default"/>.</t>
        <t>This document makes use of terms from <xref target="RFC8941" format="default"/>.</t>
      </section>
    </section>
    <section anchor="providing-ohai-feedback" numbered="true" toc="default">
      <name>Providing RateLimit information to an Oblivious proxy</name>
      <t>An Oblivious resource that uses
RateLimit fields to return service limit information
MAY add the <tt>ohai-target</tt> quota policy parameter
defined in <xref target="ohai-target-parameter" format="default"/> to signal to the receiver that
the associated quota policy is intended for an Oblivious proxy.</t>
      <t>The term "Oblivious Proxy Feedback" denotes both the mechanism
described in this specification and the complete set of
RateLimit fields together with the <tt>ohai-target</tt> parameter.</t>
      <t>To know whether the RateLimit fields provides Oblivious Proxy Feedback
(see <xref target="ohai-target-processing" format="default"/>), an Oblivious proxy MUST:</t>
      <ol spacing="normal" type="1"><li>identify the quota policy associated to the expiring limit;</li>
        <li>check whether the <tt>ohai-target</tt> parameter is present and
its syntax is correct.</li>
      </ol>
      <t>In the example below, the expiring limit value is <tt>100</tt>,
so the associated quota policy the second one.
This quota policy includes the <tt>ohai-target</tt> parameter:
this indicates that the RateLimit fields  are intended for an Oblivious proxy.</t>
      <figure anchor="example-1">
        <name>An Example of Oblivious Proxy Feedback</name>
        <sourcecode type="http-message"><![CDATA[
RateLimit-Limit: 100, 10;w=1, 100;w=60;ohai-target=1
RateLimit-Remaining: 8
RateLimit-Reset: 15
]]></sourcecode>
      </figure>
    </section>
    <section anchor="ohai-target-parameter" numbered="true" toc="default">
      <name>The ohai-target Quota Policy Parameter</name>
      <t>The following quota policy parameter is defined (see <xref target="RATELIMIT" format="default"/>).</t>
      <dl>
        <dt>
ohai-target:  </dt>
        <dd>
          <t>The OPTIONAL "ohai-target" parameter indicates that the associated
quota policy provides Oblivious Proxy Feedback.
Its syntax is defined in <xref target="ohai-target-parameter" format="default"/>.</t>
        </dd>
      </dl>
      <t>Its type MUST be Integer (see <xref section="3.3.1" sectionFormat="of" target="STRUCTURED-FIELDS" format="default"/>
with the following allowed values:</t>
      <dl>
        <dt>
1:  </dt>
        <dd>
          <t>this value indicates that RateLimit fields are applicable to
all the clients that are serviced by the Oblivious proxy.</t>
        </dd>
        <dt>
2:  </dt>
        <dd>
          <t>this value indicates that RateLimit fields are applicable only
to the client that issued the request.
For example, this value could be used if the
server thinks the client behavior is malicious (see <xref target="sec-attack-categories" format="default"/>).</t>
        </dd>
      </dl>
      <t>This parameter MUST NOT appear more than once in a quota policy.</t>
      <t>If the parameter or its value are malformed it MUST be ignored,
and proxies MUST NOT attempt to fix neither the parameter nor the value.
In this case the RateLimit fields MUST not be considered as providing Proxy Feedback.</t>
      <section anchor="ohai-target-processing" numbered="true" toc="default">
        <name>Processing ohai-target</name>
        <t>An Oblivious proxy receiving
RateLimit fields providing Oblivious Proxy Feedback,
(see <xref target="providing-ohai-feedback" format="default"/>):</t>
        <ol spacing="normal" type="1"><li>MUST remove the RateLimit fields from the Oblivious response,
since they are not intended to be forwarded to the Oblivious client;</li>
          <li>MAY replace the RateLimit fields with a new set of RateLimit fields
that are intended to be forwarded to the Oblivious client.</li>
        </ol>
        <t>An Oblivious request resource receiving
RateLimit fields providing Oblivious Proxy Feedback MUST:</t>
        <ol spacing="normal" type="1"><li>remove the RateLimit fields from the Oblivious target resource response,
since they are not intended to be forwarded to the Oblivious client;</li>
          <li>encapsulate the resulting response in the content of the Encapsulated response;</li>
          <li>add the above RateLimit fields to the Encapsulated response,
so that the Oblivious proxy can access them.</li>
        </ol>
        <t>The above behavior is consistent with the Intermediaries section
of <xref target="RATELIMIT" format="default"/> since the Oblivious proxy and request resource can
be considered part of the originating service infrastructure.</t>
        <t>If an Oblivious Proxy Feedback is generated by the
Oblivious request resource before removing the protection
(including being unable to remove encapsulation for any reason,
see <xref section="6.2" sectionFormat="of" target="OHTTP" format="default"/>), it will result in the RateLimit fields added
in the status code being sent without protection in response to a
POST request from a client.</t>
        <t>While this specification does not mandate
specific traffic shaping actions for Oblivious proxies
in addition to the ones indicated in <xref target="RATELIMIT" format="default"/>,
an Oblivious proxy failing
to reshape traffic from a specific client or from all the clients
according to the received Oblivious Proxy Feedback
can experience different levels
of service denial by Oblivious request and target resources.</t>
        <t>An example mitigation could be to throttle out clients with an
high ration of requests considered malicious (see <xref target="attack-severity-parameter" format="default"/>).</t>
      </section>
    </section>
    <section anchor="attack-severity-parameter" numbered="true" toc="default">
      <name>The attack-severity Quota Policy Parameter</name>
      <t>The following quota policy parameter is defined (see <xref target="RATELIMIT" format="default"/>).</t>
      <dl>
        <dt>
attack-severity:  </dt>
        <dd>
          <t>The OPTIONAL "attack-severity" parameter is used by
Oblivious resource to convey the likeliness
that an Oblivious request is malicious.</t>
        </dd>
      </dl>
      <t>Its value is an Integer (see <xref section="3.3.1" sectionFormat="of" target="STRUCTURED-FIELDS" format="default"/>
which takes one of the values defined in
<xref section="3.12.2" sectionFormat="of" target="RFC7970" format="default"/>.</t>
      <t>This parameter MUST NOT appear more than once in a quota policy.</t>
      <t>If the parameter or its value are malformed it MUST be ignored,
and proxies MUST NOT attempt to fix neither the parameter nor the value.</t>
    </section>
    <section anchor="security-considerations" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>Security considerations for the Oblivious HTTP protocol
(see <xref section="8" sectionFormat="of" target="OHTTP" format="default"/>)
as well as the ones for RateLimit-Limit fields
(see  <xref section="6" sectionFormat="of" target="RATELIMIT" format="default"/>) apply.</t>
      <section anchor="client-proxy-collusion" numbered="true" toc="default">
        <name>Client-Proxy collusion</name>
        <t>While <xref target="OHTTP" format="default"/> is based on the Oblivious proxy not
leaking the client identity to the Oblivious resources,
it might be the case that the Oblivious proxy colludes with
clients in attacking the Oblivious resources.</t>
        <t>RateLimit fields
might disclose operational capacity information useful to design
denial of service attacks or to circumvent defensive measures
put in place by the Oblivious resources
(see <xref section="6.2" sectionFormat="of" target="RATELIMIT" format="default"/>).</t>
        <t>The Oblivious target and request resources SHOULD convey
Oblivious Proxy Feedback only to trusted
Oblivious proxies.</t>
      </section>
      <section anchor="sec-attack-categories" numbered="true" toc="default">
        <name>Attack categories</name>
        <t>Attacks against Oblivious Resources
can be classified into three categories:</t>
        <ol spacing="normal" type="1"><li>A client deliberately sends a malformed encapsulated request
to consume computational resources of the Oblivious architecture
e.g. via the decryption process, or triggering the generation
of error responses;</li>
          <li>A client deliberately sends a request that triggers an error on
the Oblivious target resource.  This might be a malformed HTTP
request, or request for a missing resource.</li>
          <li>A botnet performing an application layer denial of service
attack (e.g. HTTP flood) against an Oblivious resource.
Because each bot makes seemingly legitimate network requests,
the traffic between the Oblivious proxy and the clients appears normal,
nonetheless as a whole it not only can saturate the Oblivious resources,
but also makes appear the Oblivious proxy as an attacker.</li>
        </ol>
      </section>
    </section>
    <section anchor="iana-considerations" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <section anchor="ratelimit-parameter-value-registrations" numbered="true" toc="default">
        <name>RateLimit Parameter Value Registrations</name>
        <t>This specification requests IANA to add the following
parameters to the "Hypertext Transfer Protocol (HTTP) RateLimit
Parameters" registry defined in <xref target="RATELIMIT" format="default"/>.</t>
        <table align="center">
          <thead>
            <tr>
              <th align="left">Field Name</th>
              <th align="left">Parameter Name</th>
              <th align="left">Description</th>
              <th align="left">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">RateLimit-Limit</td>
              <td align="left">ohai-target</td>
              <td align="left">ohttp ratelimit</td>
              <td align="left">
                <xref target="ohai-target-parameter" format="default"/>      of this document</td>
            </tr>
            <tr>
              <td align="left">RateLimit-Limit</td>
              <td align="left">attack-severity</td>
              <td align="left">ohttp ratelimit</td>
              <td align="left">
                <xref target="attack-severity-parameter" format="default"/>  of this document</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
  </middle>
  <back>
    <references>
      <name>Normative References</name>
      <reference anchor="OHTTP">
        <front>
          <title>Oblivious HTTP</title>
          <author fullname="Martin Thomson">
            <organization>Mozilla</organization>
          </author>
          <author fullname="Christopher A. Wood">
            <organization>Cloudflare</organization>
          </author>
          <date day="15" month="February" year="2022"/>
          <abstract>
            <t>   This document describes a system for the forwarding of encrypted HTTP
   messages.  This allows a client to make multiple requests of a server
   without the server being able to link those requests to the client or
   to identify the requests as having come from the same client.

            </t>
          </abstract>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-ietf-ohai-ohttp-01"/>
      </reference>
      <reference anchor="HTTP">
        <front>
          <title>HTTP Semantics</title>
          <author fullname="Roy T. Fielding">
            <organization>Adobe</organization>
          </author>
          <author fullname="Mark Nottingham">
            <organization>Fastly</organization>
          </author>
          <author fullname="Julian Reschke">
            <organization>greenbytes GmbH</organization>
          </author>
          <date day="12" month="September" year="2021"/>
          <abstract>
            <t>   The Hypertext Transfer Protocol (HTTP) is a stateless application-
   level protocol for distributed, collaborative, hypertext information
   systems.  This document describes the overall architecture of HTTP,
   establishes common terminology, and defines aspects of the protocol
   that are shared by all versions.  In this definition are core
   protocol elements, extensibility mechanisms, and the "http" and
   "https" Uniform Resource Identifier (URI) schemes.

   This document updates RFC 3864 and obsoletes RFC 2818, RFC 7231, RFC
   7232, RFC 7233, RFC 7235, RFC 7538, RFC 7615, RFC 7694, and portions
   of RFC 7230.

            </t>
          </abstract>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-ietf-httpbis-semantics-19"/>
      </reference>
      <reference anchor="RATELIMIT">
        <front>
          <title>RateLimit Fields for HTTP</title>
          <author fullname="Roberto Polli">
            <organization>Team Digitale, Italian Government</organization>
          </author>
          <author fullname="Alejandro Martinez Ruiz">
            <organization>Red Hat</organization>
          </author>
          <date day="7" month="March" year="2022"/>
          <abstract>
            <t>   This document defines the RateLimit-Limit, RateLimit-Remaining,
   RateLimit-Reset fields for HTTP, thus allowing servers to publish
   current service limits and clients to shape their request policy and
   avoid being throttled out.

            </t>
          </abstract>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-ietf-httpapi-ratelimit-headers-03"/>
      </reference>
      <reference anchor="STRUCTURED-FIELDS">
        <front>
          <title>Structured Field Values for HTTP</title>
          <author fullname="M. Nottingham" initials="M." surname="Nottingham">
            <organization/>
          </author>
          <author fullname="P-H. Kamp" initials="P-H." surname="Kamp">
            <organization/>
          </author>
          <date month="February" year="2021"/>
          <abstract>
            <t>This document describes a set of data types and associated algorithms that are intended to make it easier and safer to define and handle HTTP header and trailer fields, known as "Structured Fields", "Structured Headers", or "Structured Trailers". It is intended for use by specifications of new HTTP fields that wish to use a common syntax that is more restrictive than traditional HTTP field values.</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="8941"/>
        <seriesInfo name="DOI" value="10.17487/RFC8941"/>
      </reference>
      <reference anchor="RFC2119">
        <front>
          <title>Key words for use in RFCs to Indicate Requirement Levels</title>
          <author fullname="S. Bradner" initials="S." surname="Bradner">
            <organization/>
          </author>
          <date month="March" year="1997"/>
          <abstract>
            <t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
          </abstract>
        </front>
        <seriesInfo name="BCP" value="14"/>
        <seriesInfo name="RFC" value="2119"/>
        <seriesInfo name="DOI" value="10.17487/RFC2119"/>
      </reference>
      <reference anchor="RFC8174">
        <front>
          <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
          <author fullname="B. Leiba" initials="B." surname="Leiba">
            <organization/>
          </author>
          <date month="May" year="2017"/>
          <abstract>
            <t>RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
          </abstract>
        </front>
        <seriesInfo name="BCP" value="14"/>
        <seriesInfo name="RFC" value="8174"/>
        <seriesInfo name="DOI" value="10.17487/RFC8174"/>
      </reference>
      <reference anchor="RFC8941">
        <front>
          <title>Structured Field Values for HTTP</title>
          <author fullname="M. Nottingham" initials="M." surname="Nottingham">
            <organization/>
          </author>
          <author fullname="P-H. Kamp" initials="P-H." surname="Kamp">
            <organization/>
          </author>
          <date month="February" year="2021"/>
          <abstract>
            <t>This document describes a set of data types and associated algorithms that are intended to make it easier and safer to define and handle HTTP header and trailer fields, known as "Structured Fields", "Structured Headers", or "Structured Trailers". It is intended for use by specifications of new HTTP fields that wish to use a common syntax that is more restrictive than traditional HTTP field values.</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="8941"/>
        <seriesInfo name="DOI" value="10.17487/RFC8941"/>
      </reference>
      <reference anchor="RFC7970">
        <front>
          <title>The Incident Object Description Exchange Format Version 2</title>
          <author fullname="R. Danyliw" initials="R." surname="Danyliw">
            <organization/>
          </author>
          <date month="November" year="2016"/>
          <abstract>
            <t>The Incident Object Description Exchange Format (IODEF) defines a data representation for security incident reports and indicators commonly exchanged by operational security teams for mitigation and watch and warning.  This document describes an updated information model for the IODEF and provides an associated data model specified with the XML schema.  This new information and data model obsoletes RFCs 5070 and 6685.</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="7970"/>
        <seriesInfo name="DOI" value="10.17487/RFC7970"/>
      </reference>
    </references>
    <section anchor="examples" numbered="true" toc="default">
      <name>Examples</name>
      <section anchor="use-of-ohai-target-and-attack-severity" numbered="true" toc="default">
        <name>Use of ohai-target and attack-severity</name>
        <t>The following example illustrates the use of ohai-target and attack-severity
quota policy parameters.</t>
        <t>An Oblivious target resource receives a malformed
oblivious request coming from an Oblivious request resource
request and
identifies the sender using its source IP address.</t>
        <t>It thus generates an error response including Oblivious Proxy Feedback
information with the <tt>ohai-target</tt> quota policy parameter.</t>
        <t>The Oblivious request resource then:</t>
        <ol spacing="normal" type="1"><li>copies the RateLimit fields from the original response;</li>
          <li>removes them from the original response before encapsulating it;</li>
          <li>generates a single 200 encapsulated response for the oblivious proxy resource
along with the copied RateLimit fields.</li>
        </ol>
        <figure anchor="fig-overview">
          <name>An Example of Ratelimit Feedback to Proxy</name>
          <sourcecode type="aasvg"><![CDATA[
+----+              +----------+               +----------+          +-----------+
| C  |              | Proxy    |               | Request  |          | Target    |
|    |              | Resource |               | Resource |          | Resource  |
+-+--+              +----+-----+               +-----+----+          +------+----+
  |                      |                           |                      |
  | Encapsulated         |                           |                      |
  +--------------------->|                           |                      |
  |  Request             |                           |                      |
  |                      | Encapsulated              |                      |
  |                      +-------------------------->|                      |
  |                      |  Request                  |                      |
  |                      |                           | Request              | .---------.
  |                      |                           +--------------------->| | Identify|
  |                      |                           |                      +-+malformed|
  |                      |                           |                      | | request |
  |                      |                           |         400 response | '---------'
  |                      |                           |<---------------------+
  |                      |                           |                      |
  |                      | 200 response with         |                      |
  |                      | RateLimit-Limit           |                      |
  |                      | field and the             |                      |
  |                      | ohai-target parameter     |                      |
                         |<--------------------------+                      |
.---------------------.  |   Encapsulated 400        |                      |
| Process             |  |       response            |                      |
| ohai-target     +--+                               |                      |
| and applies         |  |                           |                      |
| rate-limit for the  |  |                           |                      |
| offending client    |  |                           |                      |
'---------------------'  |                           |                      |
                         |                           |                      |
  |                      |                           |                      |
  | Encapsulated 400     |                           |                      |
  |<---------------------+                           |                      |
  |     response         |                           |                      |
  |                      |                           |                      |
]]></sourcecode>
        </figure>
        <t>The response constructed by the Oblivious request resource is
depicted below, and includes an unregistered, informative <tt>comment</tt> quota policy
parameter providing a rationale for the <tt>attack-severity</tt>.</t>
        <sourcecode type="http-message"><![CDATA[
=============== NOTE: '\' line wrapping per RFC 8792 ================

HTTP/1.1 200 OK
Date: Wed, 27 March 2022 04:45:07 GMT
Cache-Control: private, no-store
Content-Type: message/ohttp-res
Content-Length: 38 <content is the encapsulated 400 response>
RateLimit-Limit: 10,10;w=60;ohai-target=2;attack-severity=1;\
                 comment="abnormal header matching a WAF rule"
RateLimit-Remaining: 4
RateLimit-Reset: 35

...encrypted content...
]]></sourcecode>
      </section>
    </section>
    <section anchor="acknowledgements" numbered="true" toc="default">
      <name>Acknowledgements</name>
      <t>Thanks to Lucas Pardue, Rich Salz, and Brandon Williams for the
discussion and comments.</t>
    </section>
  </back>
  <!-- ##markdown-source:
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
HPdm2b8/AAA=

-->

</rfc>
