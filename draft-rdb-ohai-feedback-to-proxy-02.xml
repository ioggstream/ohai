<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.5.5 -->
<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc docmapping="yes"?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-rdb-ohai-feedback-to-proxy-02" category="std" obsoletes="" updates="" submissionType="IETF" xml:lang="en" tocInclude="true" sortRefs="true" symRefs="true" version="3">
  <!-- xml2rfc v2v3 conversion 3.9.1 -->
  <front>
    <title>Oblivious Proxy Feedback</title>
    <seriesInfo name="Internet-Draft" value="draft-rdb-ohai-feedback-to-proxy-02"/>
    <author initials="T." surname="Reddy" fullname="Tirumaleswar Reddy">
      <organization>Akamai</organization>
      <address>
        <postal>
          <street>Embassy Golf Link Business Park</street>
          <city>Bangalore</city>
          <region>Karnataka</region>
          <code>560071</code>
          <country>India</country>
        </postal>
        <email>kondtir@gmail.com</email>
      </address>
    </author>
    <author initials="D." surname="Wing" fullname="Dan Wing">
      <organization abbrev="Citrix">Citrix Systems, Inc</organization>
      <address>
        <postal>
          <street>4988 Great America Pkwy</street>
          <city>Santa Clara</city>
          <region>CA</region>
          <code>95054</code>
          <country>USA</country>
        </postal>
        <email>danwing@gmail.com</email>
      </address>
    </author>
    <author initials="M." surname="Boucadair" fullname="Mohamed Boucadair">
      <organization>Orange</organization>
      <address>
        <postal>
          <city>Rennes</city>
          <code>35000</code>
          <country>France</country>
        </postal>
        <email>mohamed.boucadair@orange.com</email>
      </address>
    </author>
    <date year="2022" month="April" day="28"/>
    <area>Security</area>
    <workgroup>ohai</workgroup>
    <keyword>Internet-Draft</keyword>
    <abstract>
      <t>This specification enables a server to convey rate limit information
to an oblivious proxy,
which can thus use them to apply rate limit policies
on oblivious clients.
Cooperating oblivious proxies can thus provide more
equitable service to their distinguishable clients
without impacting
on the other proxied clients.</t>
    </abstract>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" toc="default">
      <name>Introduction</name>
      <t>Servers use service management techniques like rate limiting
(see <xref section="1" sectionFormat="of" target="RATELIMIT" format="default"/>)
to protect their platforms and provide equitable service to clients.</t>
      <t>Privacy features provided by Oblivious HTTP <xref target="OHTTP" format="default"/>
reduce the set of information available to origin servers,
that cannot rely for example on the source IP address of the client
to implement service limit policies:
this can be problematic (see <xref section="8.2.1" sectionFormat="of" target="OHTTP" format="default"/>)
as origin servers might thus end to throttle out all the clients
behind a proxy.</t>
      <t>This document defines a mechanism
that allows Oblivious request and target resource
to provide service limit information to an Oblivious proxy
via the RateLimit fields defined in <xref target="RATELIMIT" format="default"/>.
The Oblivious proxy can then use this information
to apply service limit policies on oblivious clients.
This is useful when such servers identify traffic anomalies
or unexpected request volumes.</t>
      <t>Specifically, the described mechanism enables a way to
identify whenever the RateLimit fields are intended for
the Oblivious client or for the Oblivious proxy.</t>
      <t>How an Oblivious proxy can use this information to avoid being throttled
out or shape the request policy is outside the scope of this specification.</t>
      <section anchor="terminology" numbered="true" toc="default">
        <name>Terminology</name>
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP&nbsp;14 <xref target="RFC2119" format="default"/> <xref target="RFC8174" format="default"/> when, and only when, they
appear in all capitals, as shown here.</t>
        <t>The terms
"Encapsulated request", "Encapsulated response",
"Oblivious proxy resource", "Oblivious request resource",
"Oblivious target resource" are to be interpreted as described
in <xref target="OHTTP" format="default"/>.</t>
        <t>The collective term "Oblivious resource" indicates either
an "Oblivious request resource" or an "Oblivious target resource".</t>
        <t>The terms "content", "receiver", "request" and "response"
are to be interpreted as described in <xref target="HTTP" format="default"/>.</t>
        <t>The terms "quota policy", "service limit", "expiring limit"
and "RateLimit fields"
are to be interpreted as described in <xref target="RATELIMIT" format="default"/>.</t>
        <t>This document uses the Integer type
from <xref target="STRUCTURED-FIELDS" format="default"/>.</t>
        <t>This document makes use of terms from <xref target="RFC8941" format="default"/>.</t>
      </section>
    </section>
    <section anchor="providing-ohai-feedback" numbered="true" toc="default">
      <name>Providing RateLimit information to an Oblivious proxy</name>
      <t>An Oblivious resource that uses
RateLimit fields to return service limit information
MAY add the <tt>ohai-target</tt> quota policy parameter
defined in <xref target="ohai-target-parameter" format="default"/> to signal to the receiver that
the associated quota policy is intended for an Oblivious proxy.</t>
      <t>The term "Oblivious Proxy Feedback" denotes both the mechanism
described in this specification and the complete set of
RateLimit fields together with the <tt>ohai-target</tt> parameter.</t>
      <t>To know whether the RateLimit fields provides Oblivious Proxy Feedback
(see <xref target="ohai-target-processing" format="default"/>), an Oblivious proxy MUST:</t>
      <ol spacing="normal" type="1"><li>identify the quota policy associated to the expiring limit;</li>
        <li>check whether the <tt>ohai-target</tt> parameter is present and
its syntax is correct.</li>
      </ol>
      <t>In the example below, the expiring limit value is <tt>100</tt>,
so the associated quota policy the second one.
This quota policy includes the <tt>ohai-target</tt> parameter:
this indicates that the RateLimit fields  are intended for an Oblivious proxy.</t>
      <figure anchor="example-1">
        <name>An Example of Oblivious Proxy Feedback</name>
        <sourcecode type="http-message"><![CDATA[
RateLimit-Limit: 100, 10;w=1, 100;w=60;ohai-target=1
RateLimit-Remaining: 8
RateLimit-Reset: 15
]]></sourcecode>
      </figure>
    </section>
    <section anchor="ohai-target-parameter" numbered="true" toc="default">
      <name>The ohai-target Quota Policy Parameter</name>
      <t>The following quota policy parameter is defined (see <xref target="RATELIMIT" format="default"/>).</t>
      <dl>
        <dt>
ohai-target:  </dt>
        <dd>
          <t>The OPTIONAL "ohai-target" parameter indicates that the associated
quota policy provides Oblivious Proxy Feedback.
Its syntax is defined in <xref target="ohai-target-parameter" format="default"/>.</t>
        </dd>
      </dl>
      <t>Its type MUST be Integer (see <xref section="3.3.1" sectionFormat="of" target="STRUCTURED-FIELDS" format="default"/>
with the following allowed values:</t>
      <dl>
        <dt>
1:  </dt>
        <dd>
          <t>this value indicates that RateLimit fields are applicable to
all the clients that are serviced by the Oblivious proxy.</t>
        </dd>
        <dt>
2:  </dt>
        <dd>
          <t>this value indicates that RateLimit fields are applicable only
to the client that issued the request.
For example, this value could be used if the
server thinks the client behavior is malicious (see <xref target="sec-attack-categories" format="default"/>).</t>
        </dd>
      </dl>
      <t>This parameter MUST NOT appear more than once in a quota policy.</t>
      <t>If the parameter or its value are malformed it MUST be ignored,
and proxies MUST NOT attempt to fix neither the parameter nor the value.
In this case the RateLimit fields MUST not be considered as providing Proxy Feedback.</t>
      <section anchor="ohai-target-processing" numbered="true" toc="default">
        <name>Processing ohai-target</name>
        <t>An Oblivious proxy receiving
RateLimit fields providing Oblivious Proxy Feedback,
(see <xref target="providing-ohai-feedback" format="default"/>):</t>
        <ol spacing="normal" type="1"><li>MUST remove the RateLimit fields from the Oblivious response,
since they are not intended to be forwarded to the Oblivious client;</li>
          <li>MAY replace the RateLimit fields with a new set of RateLimit fields
that are intended to be forwarded to the Oblivious client.</li>
        </ol>
        <t>An Oblivious request resource receiving
RateLimit fields providing Oblivious Proxy Feedback MUST:</t>
        <ol spacing="normal" type="1"><li>remove the RateLimit fields from the Oblivious target resource response,
since they are not intended to be forwarded to the Oblivious client;</li>
          <li>encapsulate the resulting response in the content of the Encapsulated response;</li>
          <li>add the above RateLimit fields to the Encapsulated response,
so that the Oblivious proxy can access them.</li>
        </ol>
        <t>The above behavior is consistent with the Intermediaries section
of <xref target="RATELIMIT" format="default"/> since the Oblivious proxy and request resource can
be considered part of the originating service infrastructure.</t>
        <t>If an Oblivious Proxy Feedback is generated by the
Oblivious request resource before removing the protection
(including being unable to remove encapsulation for any reason,
see <xref section="6.2" sectionFormat="of" target="OHTTP" format="default"/>), it will result in the RateLimit fields added
in the status code being sent without protection in response to a
POST request from a client.</t>
        <t>While this specification does not mandate
specific traffic shaping actions for Oblivious proxies
in addition to the ones indicated in <xref target="RATELIMIT" format="default"/>,
an Oblivious proxy failing
to reshape traffic from a specific client or from all the clients
according to the received Oblivious Proxy Feedback
can experience different levels
of service denial by Oblivious request and target resources.</t>
        <t>An example mitigation could be to throttle out clients with an
high ration of requests considered malicious (see <xref target="attack-severity-parameter" format="default"/>).</t>
      </section>
    </section>
    <section anchor="attack-severity-parameter" numbered="true" toc="default">
      <name>The attack-severity Quota Policy Parameter</name>
      <t>The following quota policy parameter is defined (see <xref target="RATELIMIT" format="default"/>).</t>
      <dl>
        <dt>
attack-severity:  </dt>
        <dd>
          <t>The OPTIONAL "attack-severity" parameter is used by
Oblivious resource to convey the likeliness
that an Oblivious request is malicious.</t>
        </dd>
      </dl>
      <t>Its value is an Integer (see <xref section="3.3.1" sectionFormat="of" target="STRUCTURED-FIELDS" format="default"/>
which takes one of the values defined in
<xref section="3.12.2" sectionFormat="of" target="RFC7970" format="default"/>.</t>
      <t>This parameter MUST NOT appear more than once in a quota policy.</t>
      <t>If the parameter or its value are malformed it MUST be ignored,
and proxies MUST NOT attempt to fix neither the parameter nor the value.</t>
    </section>
    <section anchor="security-considerations" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>Security considerations for the Oblivious HTTP protocol
(see <xref section="8" sectionFormat="of" target="OHTTP" format="default"/>)
as well as the ones for RateLimit-Limit fields
(see  <xref section="6" sectionFormat="of" target="RATELIMIT" format="default"/>) apply.</t>
      <section anchor="client-proxy-collusion" numbered="true" toc="default">
        <name>Client-Proxy collusion</name>
        <t>While <xref target="OHTTP" format="default"/> is based on the Oblivious proxy not
leaking the client identity to the Oblivious resources,
it might be the case that the Oblivious proxy colludes with
clients in attacking the Oblivious resources.</t>
        <t>RateLimit fields
might disclose operational capacity information useful to design
denial of service attacks or to circumvent defensive measures
put in place by the Oblivious resources
(see <xref section="6.2" sectionFormat="of" target="RATELIMIT" format="default"/>).</t>
        <t>The Oblivious target and request resources SHOULD convey
Oblivious Proxy Feedback only to trusted
Oblivious proxies.</t>
      </section>
      <section anchor="sec-attack-categories" numbered="true" toc="default">
        <name>Attack categories</name>
        <t>Attacks against Oblivious Resources
can be classified into three categories:</t>
        <ol spacing="normal" type="1"><li>A client deliberately sends a malformed encapsulated request
to consume computational resources of the Oblivious architecture
e.g. via the decryption process, or triggering the generation
of error responses;</li>
          <li>A client deliberately sends a request that triggers an error on
the Oblivious target resource.  This might be a malformed HTTP
request, or request for a missing resource.</li>
          <li>A botnet performing an application layer denial of service
attack (e.g. HTTP flood) against an Oblivious resource.
Because each bot makes seemingly legitimate network requests,
the traffic between the Oblivious proxy and the clients appears normal,
nonetheless as a whole it not only can saturate the Oblivious resources,
but also makes appear the Oblivious proxy as an attacker.</li>
        </ol>
      </section>
      <section anchor="sec-information-disclosure" numbered="true" toc="default">
        <name>Information disclosure</name>
        <t>Since the Oblivious Proxy Feedback is intended to be used
only by the Oblivious Proxy,
if either
an Oblivious resource does not strip off the Oblivious Proxy Feedback
from the encrpyted content,
or an Oblivious proxy does not strip off the Oblivious Proxy Feedback
before forwarding the response to the client,
there might be information disclosure.</t>
        <t>This can happen due to faulty implemented oblivious servers
or to the presence of further intermediaries along the chain.</t>
      </section>
    </section>
    <section anchor="iana-considerations" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <section anchor="ratelimit-parameter-value-registrations" numbered="true" toc="default">
        <name>RateLimit Parameter Value Registrations</name>
        <t>This specification requests IANA to add the following
parameters to the "Hypertext Transfer Protocol (HTTP) RateLimit
Parameters" registry defined in <xref target="RATELIMIT" format="default"/>.</t>
        <table align="center">
          <thead>
            <tr>
              <th align="left">Field Name</th>
              <th align="left">Parameter Name</th>
              <th align="left">Description</th>
              <th align="left">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">RateLimit-Limit</td>
              <td align="left">ohai-target</td>
              <td align="left">ohttp ratelimit</td>
              <td align="left">
                <xref target="ohai-target-parameter" format="default"/>      of this document</td>
            </tr>
            <tr>
              <td align="left">RateLimit-Limit</td>
              <td align="left">attack-severity</td>
              <td align="left">ohttp ratelimit</td>
              <td align="left">
                <xref target="attack-severity-parameter" format="default"/>  of this document</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
  </middle>
  <back>
    <references>
      <name>Normative References</name>
      <reference anchor="OHTTP">
        <front>
          <title>Oblivious HTTP</title>
          <author fullname="Martin Thomson">
            <organization>Mozilla</organization>
          </author>
          <author fullname="Christopher A. Wood">
            <organization>Cloudflare</organization>
          </author>
          <date day="15" month="February" year="2022"/>
          <abstract>
            <t>   This document describes a system for the forwarding of encrypted HTTP
   messages.  This allows a client to make multiple requests of a server
   without the server being able to link those requests to the client or
   to identify the requests as having come from the same client.

            </t>
          </abstract>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-ietf-ohai-ohttp-01"/>
      </reference>
      <reference anchor="HTTP">
        <front>
          <title>HTTP Semantics</title>
          <author fullname="Roy T. Fielding">
            <organization>Adobe</organization>
          </author>
          <author fullname="Mark Nottingham">
            <organization>Fastly</organization>
          </author>
          <author fullname="Julian Reschke">
            <organization>greenbytes GmbH</organization>
          </author>
          <date day="12" month="September" year="2021"/>
          <abstract>
            <t>   The Hypertext Transfer Protocol (HTTP) is a stateless application-
   level protocol for distributed, collaborative, hypertext information
   systems.  This document describes the overall architecture of HTTP,
   establishes common terminology, and defines aspects of the protocol
   that are shared by all versions.  In this definition are core
   protocol elements, extensibility mechanisms, and the "http" and
   "https" Uniform Resource Identifier (URI) schemes.

   This document updates RFC 3864 and obsoletes RFC 2818, RFC 7231, RFC
   7232, RFC 7233, RFC 7235, RFC 7538, RFC 7615, RFC 7694, and portions
   of RFC 7230.

            </t>
          </abstract>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-ietf-httpbis-semantics-19"/>
      </reference>
      <reference anchor="RATELIMIT">
        <front>
          <title>RateLimit Fields for HTTP</title>
          <author fullname="Roberto Polli">
            <organization>Team Digitale, Italian Government</organization>
          </author>
          <author fullname="Alejandro Martinez Ruiz">
            <organization>Red Hat</organization>
          </author>
          <date day="7" month="March" year="2022"/>
          <abstract>
            <t>   This document defines the RateLimit-Limit, RateLimit-Remaining,
   RateLimit-Reset fields for HTTP, thus allowing servers to publish
   current service limits and clients to shape their request policy and
   avoid being throttled out.

            </t>
          </abstract>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-ietf-httpapi-ratelimit-headers-03"/>
      </reference>
      <reference anchor="STRUCTURED-FIELDS">
        <front>
          <title>Structured Field Values for HTTP</title>
          <author fullname="M. Nottingham" initials="M." surname="Nottingham">
            <organization/>
          </author>
          <author fullname="P-H. Kamp" initials="P-H." surname="Kamp">
            <organization/>
          </author>
          <date month="February" year="2021"/>
          <abstract>
            <t>This document describes a set of data types and associated algorithms that are intended to make it easier and safer to define and handle HTTP header and trailer fields, known as "Structured Fields", "Structured Headers", or "Structured Trailers". It is intended for use by specifications of new HTTP fields that wish to use a common syntax that is more restrictive than traditional HTTP field values.</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="8941"/>
        <seriesInfo name="DOI" value="10.17487/RFC8941"/>
      </reference>
      <reference anchor="RFC2119">
        <front>
          <title>Key words for use in RFCs to Indicate Requirement Levels</title>
          <author fullname="S. Bradner" initials="S." surname="Bradner">
            <organization/>
          </author>
          <date month="March" year="1997"/>
          <abstract>
            <t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
          </abstract>
        </front>
        <seriesInfo name="BCP" value="14"/>
        <seriesInfo name="RFC" value="2119"/>
        <seriesInfo name="DOI" value="10.17487/RFC2119"/>
      </reference>
      <reference anchor="RFC8174">
        <front>
          <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
          <author fullname="B. Leiba" initials="B." surname="Leiba">
            <organization/>
          </author>
          <date month="May" year="2017"/>
          <abstract>
            <t>RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
          </abstract>
        </front>
        <seriesInfo name="BCP" value="14"/>
        <seriesInfo name="RFC" value="8174"/>
        <seriesInfo name="DOI" value="10.17487/RFC8174"/>
      </reference>
      <reference anchor="RFC8941">
        <front>
          <title>Structured Field Values for HTTP</title>
          <author fullname="M. Nottingham" initials="M." surname="Nottingham">
            <organization/>
          </author>
          <author fullname="P-H. Kamp" initials="P-H." surname="Kamp">
            <organization/>
          </author>
          <date month="February" year="2021"/>
          <abstract>
            <t>This document describes a set of data types and associated algorithms that are intended to make it easier and safer to define and handle HTTP header and trailer fields, known as "Structured Fields", "Structured Headers", or "Structured Trailers". It is intended for use by specifications of new HTTP fields that wish to use a common syntax that is more restrictive than traditional HTTP field values.</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="8941"/>
        <seriesInfo name="DOI" value="10.17487/RFC8941"/>
      </reference>
      <reference anchor="RFC7970">
        <front>
          <title>The Incident Object Description Exchange Format Version 2</title>
          <author fullname="R. Danyliw" initials="R." surname="Danyliw">
            <organization/>
          </author>
          <date month="November" year="2016"/>
          <abstract>
            <t>The Incident Object Description Exchange Format (IODEF) defines a data representation for security incident reports and indicators commonly exchanged by operational security teams for mitigation and watch and warning.  This document describes an updated information model for the IODEF and provides an associated data model specified with the XML schema.  This new information and data model obsoletes RFCs 5070 and 6685.</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="7970"/>
        <seriesInfo name="DOI" value="10.17487/RFC7970"/>
      </reference>
    </references>
    <section anchor="examples" numbered="true" toc="default">
      <name>Examples</name>
      <section anchor="use-of-ohai-target-and-attack-severity" numbered="true" toc="default">
        <name>Use of ohai-target and attack-severity</name>
        <t>The following example illustrates the use of ohai-target and attack-severity
quota policy parameters.</t>
        <t>An Oblivious target resource receives a malformed
oblivious request coming from an Oblivious request resource
request and
identifies the sender using its source IP address.</t>
        <t>It thus generates an error response including Oblivious Proxy Feedback
information with the <tt>ohai-target</tt> quota policy parameter.</t>
        <t>The Oblivious request resource then:</t>
        <ol spacing="normal" type="1"><li>copies the RateLimit fields from the original response;</li>
          <li>removes them from the original response before encapsulating it;</li>
          <li>generates a single 200 encapsulated response for the oblivious proxy resource
along with the copied RateLimit fields.</li>
        </ol>
        <figure anchor="fig-overview">
          <name>An Example of Ratelimit Feedback to Proxy</name>
          <sourcecode type="aasvg"><![CDATA[
+----+              +----------+               +----------+          +-----------+
| C  |              | Proxy    |               | Request  |          | Target    |
|    |              | Resource |               | Resource |          | Resource  |
+-+--+              +----+-----+               +-----+----+          +------+----+
  |                      |                           |                      |
  | Encapsulated         |                           |                      |
  +--------------------->|                           |                      |
  |  Request             |                           |                      |
  |                      | Encapsulated              |                      |
  |                      +-------------------------->|                      |
  |                      |  Request                  |                      |
  |                      |                           | Request              | .---------.
  |                      |                           +--------------------->| | Identify|
  |                      |                           |                      +-+malformed|
  |                      |                           |                      | | request |
  |                      |                           |         400 response | '---------'
  |                      |                           |<---------------------+
  |                      |                           |                      |
  |                      | 200 response with         |                      |
  |                      | RateLimit-Limit           |                      |
  |                      | field and the             |                      |
  |                      | ohai-target parameter     |                      |
                         |<--------------------------+                      |
.---------------------.  |   Encapsulated 400        |                      |
| Process             |  |       response            |                      |
| ohai-target     +--+                               |                      |
| and applies         |  |                           |                      |
| rate-limit for the  |  |                           |                      |
| offending client    |  |                           |                      |
'---------------------'  |                           |                      |
                         |                           |                      |
  |                      |                           |                      |
  | Encapsulated 400     |                           |                      |
  |<---------------------+                           |                      |
  |     response         |                           |                      |
  |                      |                           |                      |
]]></sourcecode>
        </figure>
        <t>The response constructed by the Oblivious request resource is
depicted below, and includes an unregistered, informative <tt>comment</tt> quota policy
parameter providing a rationale for the <tt>attack-severity</tt>.</t>
        <sourcecode type="http-message"><![CDATA[
=============== NOTE: '\' line wrapping per RFC 8792 ================

HTTP/1.1 200 OK
Date: Wed, 27 March 2022 04:45:07 GMT
Cache-Control: private, no-store
Content-Type: message/ohttp-res
Content-Length: 38 <content is the encapsulated 400 response>
RateLimit-Limit: 10,10;w=60;ohai-target=2;attack-severity=1;\
                 comment="abnormal header matching a WAF rule"
RateLimit-Remaining: 4
RateLimit-Reset: 35

...encrypted content...
]]></sourcecode>
      </section>
    </section>
    <section anchor="acknowledgements" numbered="true" toc="default">
      <name>Acknowledgements</name>
      <t>Thanks to Lucas Pardue, Rich Salz, and Brandon Williams for the
discussion and comments.</t>
    </section>
  </back>
  <!-- ##markdown-source:
H4sIAL5MamIAA91b63ITSZb+n0+RK37QBJLGNtCAGCbG2NA4xmCPbbZjo6dj
SVWlpAyXKtWZVTJa7H6WfZZ9sj3nZGZV1kUGzPTExuoHyFV5OffznZOp0WjE
ClVkcsJPpplaK11afmr0pw1/I2U6FcklS3WSiyWMSI2YFSOTTkd6IdRo5geM
Cj1a4ZRRJgppC5bAf3NtNhNui5QxtTITXpjSFns7O8939pgwUkz44FwmpVHF
ZsCutLmcG12uJhxXZpdyA4/SCT/KC2lyWYwOcWvGbCHy9D9FpnMgZyMtW6kJ
/6XQyZDDPypPZV4MudWmMHJm4dtm6b8URiXwKtHLlfBfljAYXqk8U7kccmBz
KVYrlc9/ZUyUxUKbCRsxzmGEnfCLMT+TabrBB04cF8qUS5FJeyVM/U6b+YTv
X4ol8AF/Svg/m/BLnaeFMn+d459j2BzfAVFSFhP+ejkV1m74Tzqb8WOVX/JX
pQWaLKhCmEscmoCcJvyVyOfAvJH4yMi50vmE/02YXBTiUtA4nQJlgyc/7uw8
3R24J2VeoC6O8lSJiKHDMf8ZmK35ORR59YS4GBwoENsnfr6xhVyCqI7yZBAx
lYr8CsY3mRLTqZHrCXdzYzYHj58/e8Z/AuUXfH8pQSGCn15ebQY1g4NzkReC
H2TCiEHM5MF+xN3zJztPHjeZ+3C+H7E2eDfmr3SZiFQoM6g5HLwD81rKtPWS
mD0xIFwZcbd0Y8fTMPavmoYERh3FZzIHRUXEPXqys7PTJO4NzEskY7k2S1Go
tZzA65O3FxenoJXR4VjJYuZcSi+KYgUvW+/w6VTZkQXS8kIluN/Z/sXr46N3
RxetcWKlRgYcMFNLVYwWUqTS4Pjzi7MPBxcfzl4fjt4cvT4+PAfa3xw8e/54
Fzw0n9WksdFoBFoErYGjMHaxUJbblUzUDBRWgDa4zMUUzJ4LbqVZSwO+B8zm
a7nhuDOnrXm1qM4ZDADj0lWEoXAxZFcLlSx4Aq+KBTwtrYQvconrgSdmjeVW
OlOJAlHreKEkU+jFY3ag9UrCcLDH1j4wp94CHqxVKkG54ETyt1IVyArxoRKJ
GwMByvBUWVyqVHZBA/w+7EpBXCiBOQoj6CwaV5Zcwz/G75fWZJEwlypNM9D/
PYxnRqdlQkJh5yQ9x3egABQs5hJDEy9kssjVbyXQn6lLGQkD9/3BSsk/f4Yg
SjrZ5XpW28TNzQOUOZADixSepxWEZ1QJKC5PK0n0CqGm/9SotUg2fAZeWxpZ
STDl002UMtBg+S9k078yI4FFUiWsWSBhkS1wsQb3og1hI23UXOXejuyQFQsI
DqCtXBfg+2ABMI/LT2K5gvFe1FaXBpY/OuUiTQ1GSdgBXziqkXGF40mIgamm
EU1gI+XMYiqRJSAHyUt4S6zPxntjEi2xhmIVtkU0qHe+KJx5SRAs2RAIvkCK
wVRElkXUWTaVC0hU4DzkBGPvYZB9SiI4lTMM/fB+CfoXubJLJxVYR1/ZSOZG
om0UpM1CmLlEkTnheOWTgpsSiDXhvPKk6ZVsrQTRewbmdkxzZkpmqfWUpbAE
/6WytF/HQL9sL+IdTubep4HBdjgg/+7XDu93cZKTIneZlRm/wuVtCQEkKEJh
+lezDYANMYNoBdxpSNAUNAwvc/kJwlgBHATJrXUGQkczPw8BLss2Q2I/lTYx
agqjKz1Ege9KwC6aVTsiMZJCYZ/kAPAA/wVYBywHYmBFQ2SOQzArsvaiK04g
8K2+6lEWyblPxKTbtVbgphJDYrDIlKFJwi4Q11bORYMwSPobFDAMsWg55GwJ
xFXnYO08AFTdu8cvpFmqXGd6vmFkCgDeOKI3C+n2w/nFYOj+5+9P6PvZ679/
OIIshN/P3+4fH1dfmB9x/vbkw/Fh/a2eeXDy7t3r94duMjzljUds8G7/P+AN
+sPg5PTi6OT9/vEAzbVoeBhqA8QzdToxKyPRJoRltcphzquD0//5793HEAv+
DfLk3u7u85sb/8ez3aeP4Q/UudtN59nG/wky2zAwbgmYEFZB508gJRciA/wE
scMu9FXOIVdIEB/JC0hYWjZ4ncM4WyKErgwU2Ww9tyudW4nMtk0h+D5O6gaJ
+m08sxU2BltlU7sDQ/d3gX7sGEh0lmG4XDtemruHhSHkodmA80iFqZKB4d5G
Jtpoc0ib1nEkPj4A/AH+RRIzMpFAjHHfnSCdUVTiY1/mk8JczKbf6LdSA0J1
zoI7NEIYPoAoowz6nHvCaOd2SPhqCuJA28oU4PeWfBSrpDnGns1KspnRS/5L
B+11py/FpXTYA72bmKO53sYBGN7coItjOQiJBDmqufhiGuGf763CvGa5eMPY
fs67NsIpyyFTrBNAYQuQT2ny7dmMgfMjICCJfKQdncV85LHK+ApKiyXI2rAo
n33+HE0YVUPAyWFnq+a5yDw25MG6iFwK5FC7Qe1J/tnYiSJyHfR7hBRZVmzp
zfp7ABYBcAh0NQWQSTTUyKBhLN0Q7bAB+SgioiIAsj4JA+cIYRHh9siwkgnS
rPllDvkIIh5N6c15Hn7Y7X0FD7Uakjc6AUAHNgNQa9hnVphKoEbZHUfZHrZv
CD5SiFda0ydfsL0xTxYyuWywsIVh1CN4p6XUkadUZBYg5w1Uqp/wZaINGEUB
gjnK/W4Or04lILZhDwF8LbJS4tyPuzs7H4fMOjK3WZJD0hDiMNVIj4SatpYn
WZn6eLCFEQ9660hMDtervA5i6Tfe33//nWPNOQIQZaFsqc1qRP9OOLA3hH9e
XL3cxf/xy487LyL6Xu5Gk86w9M5BTBP+rPHYYv9g9wluyD5P+D0v4dEup+bV
ywFElNehSphtNbnBDcYzjj4XkcD/TpI8dZI8rfT++V5/UHBOO9OIx1Gl/eEF
tRsiDFl6FMofgOx4TAI2BCZEV8AtfBC9HsTLdtVXmw0aZ4ueL7nhmOYcNSz6
ayIjmjtMwpxDTomZLCSiVhH1aPzIFVGdrHRzw6p4UwuUKh3YnrwEajWgcNdJ
iAzYO09TDr2YG4sMGORqTeKzVYy5uTjU5xUqa/sROOd730sE4kQiw4clD/xp
rrK2lGmMyJ1m3tQF8DDeOtFlhugeMyZoiipgmhB6MlBlXtp4Gyg8BbBEloll
UULseV1BeBmJosB2rm/fQtkEQTjAhtoAA5jnHuViKwVZgJotTySB3oYJoqG4
+rxeA4koAicoJKAHMzlyUlTmBHkX1k6HzPcrqJVTb18UcrkqUJYz9YnnDle2
Nsp9QUU7jV2ApsLftZq6GqPlsfswRRHnWAcZh8sqONNxICyDTqvM1QgtrRhS
p7cWCAoQHrEFdne2pFNcfpsjD0NC3Ya7bh64xEksGrnU6y0yIBjYdIKAnIfU
0FW5a+9sSHcorSpXOEgLurwSJq0TcLvYpRSMiM3IVSaSLYRQbBCg2qvQSGoP
QXIqH/5WIsYdJNosQr5PHxFU+UZhtyqdP0D4QJOs60ofdOAPap+G7RykJDco
qD/hvLi3IKUlA/oWU+S2D8Rvne9Y03VO62t0iAS9h1rEHjm7neLARj5rid4q
s9ApEsQWJTCoIZKiggH4iXJyLdjO3hh+OrYBBLFmjICoUwnJtQhdOzqULFCs
GGELUybYSXVhsQGrWvYD3Mxljk3tKi2xW4x1KmcYicnWXMtHhgYwcvuDg4j4
xrWEyjw0Yb151haBSduBPoxJwuocIGojpf843ou7okMM21cKkqszo2A63YSY
pq6FQJC2EAUapU6lp8kGvWGXqiYel6usEstNdnpCMcyJgFxI1E7980Jlsq8a
SjWoHz1mCSoF0lh4XXUMsS1GEIT2tSSFpjlgNxFzXJqqUP2SwrFnG+BAu3TH
DNaxqplQGYYWUoBvx3kqPEMVdVGDkN60OsrgF9qQZps1arq99kJ3wnYoOARa
fapmM7Bh2COTa5lZ9I1gtlBmKSh/G+3+W1rP1kXVUAPhacXcSb9CLO0OeQBj
LtznbKHmCzztwElAiN/Mxr7WwS8eu1hswqpiEyPVB+MK9bdGbUf+25f7Z6H/
1g59FUBryKC5POG+qcOTfd2U6kwOLQIPkDI6Unb4k1JmX+6LsaGH+FWxChPu
hPDplK+gdhO4SQiRDt1HtQaL19vdcxEGe1FPnz/doYLj/xESBYsM9x/4gbdr
sniL54L+RdJ40XM6QMduGCd1orP2keCz9rnVlYTAIWwdr3DBVskecBWtFQf8
9vmiO8Fx4PeAHHjkYgy2g0tLB5wuEPtuMVrQVKDR+nO8dkCEwMwyKS5D8vJR
z/V5ik0XzVQhZ8iAcHcMN3Up3AP8bWACScSiGCMOC+EH7YU8LhDQsxPw24Gg
buNU2STT2E1deYUJav0LvCfQ6Jf68ytgB0gAy2I+wkYx19GBJ43kx8ok5XLt
Twcl2MQae4DC4oEsW5WUbh2M7lSvFeVt6/AZPFapB1UdINqHfyz3hzMuyLCt
KIbORlB1eAEIcn8nmzoT2ieOeV17QhDur0khvXjpiLlQOdBUL3lWceuPdpNM
QL01UxRgXN6RMtrF4fP9YGspBMkpIS46nMxTOoetIoLsOaNhrpxHVy2XrtFa
FkH/tbR80KtJFSZZKMQ3pbvOI8fzMQ9nr6lMzGZFevI145BsAVAlRN9gnx4d
oqvhLZYZl8bAqICU7IuvYC7o1fmKW58ivVvLLX1reTLG1Kps7X+xxNDz3T0e
2oa4qGAbIkyY5qrmajlP9FQXOewCzoRLESbLQy+FBJOJDYTVju/QHSRnTD+Q
TClGzjKt0weVxYi+Awjqt7ySicAzESkgZ011OCYB30EaQHCZnAOkWWLZBPTh
zbUKoAyDrAKOm8IAKfujXdWZ99HH5TCEpxAnMloqhyANQzIsegSdOi80xFOI
PIhhybHQzC3ezAhlXG90hLWmdBMBKizHj8+YvYSR+p0Iqd1/D++t1OHLBzow
W++iUWwb1S/BT897KqpujdOqXhHWMOKtE8tO3a0hNYvOEHuQT4Xy8dLfCkyj
7XotLFxV4ODeZrVB3/Yl75D1dr6/eQdfmvnCPLhvXNHUloB3YCTikOBOqlf2
AQ2hASxQm/CypKVmAgqwTX0FBhNuRZi/KsFcYnElIh5tJATLZqUh5KKaBTPe
t/QpeQH+gwfXgKeP9t/vd6AL2EpU9NWI+t8JX52B7+C9Mj+452pZhfVpdSz1
fE+hAtysglRVR2HwdgNhopCfCn5hRG6hlEENECjiP6D/P6iJYhVRdkDXC4Gg
zda7Lex61P58xZPukC99rtk1f4Nwgr8H4jh9rmvx+YfXh3Tc5xIDDTlvSO8r
Ptf/So7a2PI6bo06cujGI68uLPLrW85i6ROuolTn2L0btQu9/o1uKRr7N/pX
iY6uDVLoAE/zB1vOuz648/pYkJhJWpy0i9RQjSuE5uiA/qSw/LrV+mtc2+6f
dvuW1IZoYCimOyUnQCak0bU2buvHsqjtEK5eKc8J4hlwlJKwBJ3Ptm8JUjXL
6ZpeaKtFQCdqeoY22dZwHkfkLcfl/RLrAOxOEw/vzDlMmuhV4G17z9i3GbOo
D7sX2s2uUXrL2NAxjPp+JLsX7NE4FhF2RudgPHs7O20E7BcKhWnrgm+tODp5
wyRSiYvYSzus+UNlIex6zthD9IaHzQD2sPaT1pstr6Kno4cQKw4gGLRiolcw
77yBv8+8iuJX1/yiimEYfroTr6tSpHfJ7qvoKSz5cPSwn/GHtzDelpZn3D1m
Xd6qnbd/tk2h1RqN/O9cLVZS/fnLnWmr1fblGV+xWv+MXgHccbV+AdwqhVtp
6xXAHWm7XW69G13zcUX/+G4rbzWJa37kr/7cmeYtGz6s0tQ/d2WkOYT67175
MYThKvJe8/uVaO7fceU/9wr6j4gYW2bsxRxRhvie1dpY8Ptoo7RUFevNd9++
Wgy06tbwF1bb8tmit1ErCzRXG/cOH7v9G/EMzexLnF6Haw8tNqsZlVabr7et
1i4PukmwO237aoRksWEkbTz8TtZ7TZXDyJUOAe58x2p6NgPAinjLN+e+g7b7
vTq9f2c//bYZX1rtD0UdwUjvutqW0HdX2vDTMfn/A3IL1yZnaj6CysCslbzq
vzl5VtXHVYuu0A4e4+VJKl8qDrHnTdcZ+q7NdUobhT+wWCk32t2MRQ+tbq7i
L1ly15DBI94hj36VyD/63+s2K6u6FxTdxxE8HL/UhcnHVkX7se/yKnvZ/ODZ
3usJv/+P+xyPTvmVcT8Pxp40/naSP3v6fI+3Jr1kDBtOf9od71JeO/kbOwSZ
TvjPyNLeU/4OG//wam+P7zyePH4y2XnKf3p3wQ5EspCjA42/EMwmwI9aw7wh
z/XIFvhrxQPXkxxdbFawnCf6T9TWGOE5UHh/LPN5sZjwR8/4n8PVHWVDg7Pp
O0GVf+m7uTvc7bmuu/eiJcqXuy/+0Q0aXl0vB2LqGtrc/RKVgz6ThVPTz/tv
uCkzOei/Afy4ewP40RPGxuMx9mk3q6hPC8/Ixtk9vp/g1fRMpu5HlNRlFHQR
UvPjMhH0k+q0BMGe4an0ucj+y9nhKwP/avwFdJYpsaxOWxn2XEtrw2368MPx
MftfX5+82Dw/AAA=

-->

</rfc>
